the code is long because its full of comments but it's in fact pretty simple, you give it a try
also feel free to correct me or advise me as I am not a pro yet